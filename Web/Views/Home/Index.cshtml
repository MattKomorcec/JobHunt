@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@model List<Web.DTO_s.JobIndexDTO>

@{
    ViewData["Title"] = "All Jobs";
}


@if (SignInManager.IsSignedIn(User))
{
    @if (Model.Count == 0)
    {
        <h1 class="display-4 text-center">You have no jobs yet!</h1>
        <hr />
    }
    else
    {
        @await Html.PartialAsync("_JobStatisticsPartial", Model)

        <div class="table-responsive">
            <table class="table text-center table-hover">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">Company</th>
                        <th scope="col">Position</th>
                        <th scope="col">Date applied</th>
                        <th scope="col">Status</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var job in Model)
                    {
                        string jobStatus = job.Status == JobStatus.Accepted ? "table-success" : "";


                        <tr class="@jobStatus">
                            <th scope="row">@job.Company</th>
                            <td>@job.Position</td>
                            <td>@job.DateApplied.ToShortDateString()</td>
                            <td>@job.Status</td>
                            <td class="action-buttons-holder">
                                <a asp-controller="Home" asp-action="Details" asp-route-id="@job.JobId" class="action-buttons text-hide">
                                    <i class="fas fa-eye"></i>
                                </a>
                                <a asp-controller="Home" asp-action="Edit" asp-route-id="@job.JobId" class="action-buttons">
                                    <i class="far fa-edit"></i>
                                </a>
                                <a asp-controller="Home" asp-action="Delete" asp-route-id="@job.JobId" class="action-buttons">
                                    <i class="fas fa-trash-alt"></i>
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }

}
else
{
    @await Html.PartialAsync("_LoggedOutPartial")
}

